window.gMapsCallback=function(){$(window).trigger("gMapsCallback")},function(e,t,o,n){"use strict";function r(e){var t,o,n=0;if(e instanceof Array)for(n=0;n<e.length;n+=1)r(e[n]);else if("object"==typeof e)for(t in e)"string"!=typeof e[t]?r(e[t]):/^google\.map/gi.test(e[t])&&(o=e[t].split("."),4===o.length&&(e[t]=google.maps[o[2]][o[3]]))}function i(e,t,o){var n={lat:"",lng:""},r=[],i=/^[+-]?\d+(\.\d+)?$/;if("string"==typeof e||Array.isArray(e)){if(r=Array.isArray(e)?e:e.toString().replace(/\s+/,"").split(","),2!==r.length)return e;i.test(r[0])&&i.test(r[1])&&(n.lat=r[0],n.lng=r[1])}else if("object"==typeof e){if("function"==typeof e.lat)return e;e.hasOwnProperty("x")&&e.hasOwnProperty("y")?(n.lat=e.x,n.lng=e.y):e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")&&(n.lat=e.lat,n.lng=e.lng)}return void 0===o&&(n.lat=parseFloat(n.lat,10)+(Math.random()-.5)/5e3,n.lng=parseFloat(n.lng,10)+(Math.random()-.5)/5e3),!0===t?new google.maps.LatLng(n.lat,n.lng):n}function a(t){var o=this,n=t.hasOwnProperty("css")?t.css.toString():"";o.setValues(t),o.span=e("<span/>").css({position:"relative",left:"-50%",top:"0","white-space":"nowrap"}).addClass(n),o.div=e("<div/>").css({position:"absolute",display:"none"}),o.span.appendTo(o.div)}function s(o,n){var r=this,i=e.extend({},y,n);return r.idleOnceCount=!1,r.map=null,r._markers=[],r._markersCluster=[],r._clusters={},r._bounds={},r._labels=[],r._polylines=[],r._polygons=[],r._circles=[],r._kmls=[],r._directions=[],r._directionsMarkers=[],r._places=[],r.container=o,r.options=i,r.googleMapOptions={},r.interval=parseInt(r.options.interval,10)||200,e(t).on("gMapsCallback",function(){r.init()}),e(this.container).html(i.loading),r.init()}var l=!1,p=!1,c=!1,d=!1,g={language:"zh-TW",callback:"gMapsCallback",api:"https://maps.googleapis.com/maps/api/js",clusterer:"https://cdn.essoduke.org/js/tinyMap/markerclusterer.js",withLabel:"https://cdn.essoduke.org/js/tinyMap/markerwithlabel.js",OMS:"https://cdn.essoduke.org/js/tinyMap/oms.min.js"},y={autoLocation:!1,center:[24,121],infoWindowAutoClose:!0,interval:200,loading:"讀取中&hellip;",notFound:"找不到查詢的地點",zoom:8},f={};f={greyscale:[{featureType:"all",stylers:[{saturation:-100},{gamma:.5}]}]},s.prototype={VERSION:"3.4.10",formatSize:function(e){return Array.isArray(e)&&2===e.length?new google.maps.Size(e[0],e[1]):e},formatPoint:function(e){return Array.isArray(e)&&2===e.length?new google.maps.Point(e[0],e[1]):e},overlay:function(e){var t=this.map,o=this.options;try{this.idleOnceCount||(this.kml(t,o),this.directionService(t,o),this.placeMarkers(t,o),this.drawPolyline(t,o),this.drawPolygon(t,o),this.drawCircle(t,o),this.streetView(t,o),this.places(t,o),this.geoLocation(t,o),this.idleOnceCount=!0)}catch(e){}finally{google.maps.event.trigger(t,"resize")}},bindEvents:function(e,t){var o=this,n={};switch(typeof t){case"function":google.maps.event.clearListeners(e,"click"),google.maps.event.addListener(e,"click",t);break;case"object":for(n in t)"function"==typeof t[n]?"created"===n?t[n].call(e):(google.maps.event.clearListeners(e,n),google.maps.event.addListener(e,n,t[n])):t[n].hasOwnProperty("func")&&"function"==typeof t[n].func?t[n].hasOwnProperty("once")&&!0===t[n].once?google.maps.event.addListenerOnce(e,n,t[n].func):(google.maps.event.clearListeners(e,n),google.maps.event.addListener(e,n,t[n].func)):"function"==typeof t[n]&&(google.maps.event.clearListeners(e,n),google.maps.event.addListener(e,n,t[n]))}e.hasOwnProperty("defaultInfoWindow")&&(google.maps.event.clearListeners(e,"click"),google.maps.event.addListener(e,"click",function(){var t=0,n={};if(o.options.hasOwnProperty("infoWindowAutoClose")&&!0===o.options.infoWindowAutoClose)for(t=0;t<o._markers.length;t+=1)n=o._markers[t],n.hasOwnProperty("infoWindow")&&"function"==typeof n.infoWindow.close&&n.infoWindow.close();e.infoWindow.open(o.map,e)}))},kml:function(t,o){var n=this,r={url:"",map:t,preserveViewport:!1,suppressInfoWindows:!1},i={},a=0;if(o.hasOwnProperty("kml"))if("string"==typeof o.kml)r.url=o.kml,i=new google.maps.KmlLayer(r),this._kmls.push(i);else if(Array.isArray(o.kml))for(a=0;a<o.kml.length;a+=1)"string"==typeof o.kml[a]?(r.url=o.kml[a],i=new google.maps.KmlLayer(r)):"object"==typeof o.kml[a]&&(r=e.extend({},r,o.kml[a]),i=new google.maps.KmlLayer(r),r.hasOwnProperty("event")&&n.bindEvents(i,r.event)),this._kmls.push(i)},drawPolyline:function(t,o){var n=this,r={},a=[],s={},l={},p={},c={},d=[],g=[],y=0,f={},h={},u=0,m=function(e,t){if(t===google.maps.DirectionsStatus.OK){for(u=0;u<e.routes[0].overview_path.length;u+=1)g.push(e.routes[0].overview_path[u]);s.setPath(g),"function"==typeof r.getDistance&&(l=e.routes[0].legs[0].distance,r.getDistance.call(this,l))}};if(o.hasOwnProperty("polyline")&&Array.isArray(o.polyline))for(y=0;y<o.polyline.length;y+=1)if(r=o.polyline[y],r.hasOwnProperty("coords")&&Array.isArray(r.coords)){for(d=new google.maps.MVCArray,u=0;u<r.coords.length;u+=1)h=r.coords[u],f=i(h,!0,!1),"function"==typeof f.lat&&d.push(f);if(c=e.extend({},{strokeColor:r.color||"#FF0000",strokeOpacity:r.opacity||1,strokeWeight:r.width||2},r),s=new google.maps.Polyline(c),n._polylines.push(s),2<d.getLength())for(u=0;u<d.length;u+=1)0<u&&d.length-1>u&&a.push({location:d.getAt(u),stopover:!1});r.hasOwnProperty("event")&&n.bindEvents(s,r.event),r.hasOwnProperty("snap")&&!0===r.snap?(p=new google.maps.DirectionsService,p.route({origin:d.getAt(0),waypoints:a,destination:d.getAt(d.length-1),travelMode:google.maps.DirectionsTravelMode.DRIVING},m)):(s.setPath(d),google.maps.hasOwnProperty("geometry")&&google.maps.geometry.hasOwnProperty("spherical")&&"function"==typeof google.maps.geometry.spherical.computeDistanceBetween&&(l=google.maps.geometry.spherical.computeDistanceBetween(d.getAt(0),d.getAt(d.length-1)),"function"==typeof r.getDistance&&r.getDistance.call(n,l))),s.setMap(t)}},drawPolygon:function(t,o){var n=this,r={},a={},s=[],l=0,p=0,c={},d={};if(o.hasOwnProperty("polygon")&&Array.isArray(o.polygon))for(l=0;l<o.polygon.length;l+=1)if(s=[],o.polygon[l].hasOwnProperty("coords")){for(p=0;p<o.polygon[l].coords.length;p+=1)c=o.polygon[l].coords[p],d=i(c,!0,!1),"function"==typeof d.lat&&s.push(d);a=e.extend({},{path:s,strokeColor:o.polygon[l].color||"#FF0000",strokeOpacity:1,strokeWeight:o.polygon[l].width||2,fillColor:o.polygon[l].fillcolor||"#CC0000",fillOpacity:.35},o.polygon[l]),r=new google.maps.Polygon(a),n._polygons.push(r),r.setMap(t),a.hasOwnProperty("event")&&n.bindEvents(r,a.event)}},drawCircle:function(t,o){var n=this,r={},a={},s={},l={},p=0;if(o.hasOwnProperty("circle")&&Array.isArray(o.circle))for(p=0;p<o.circle.length;p+=1)a=o.circle[p],s=e.extend({map:t,strokeColor:a.color||"#FF0000",strokeOpacity:a.opacity||.8,strokeWeight:a.width||2,fillColor:a.fillcolor||"#FF0000",fillOpacity:a.fillopacity||.35,radius:a.radius||10,zIndex:100,id:a.hasOwnProperty("id")?a.id:""},a),a.hasOwnProperty("center")&&(l=i(a.center,!0,!1),s.center=l),"function"==typeof l.lat&&(r=new google.maps.Circle(s),n._circles.push(r),a.hasOwnProperty("event")&&n.bindEvents(r,a.event))},markerIcon:function(e){var t={};if(e.hasOwnProperty("icon")){if(t=e.icon,"string"==typeof e.icon)return e.icon;e.icon.hasOwnProperty("url")&&(t.url=e.icon.url),e.icon.hasOwnProperty("size")&&Array.isArray(e.icon.size)&&2===e.icon.size.length&&(t.size=this.formatSize(e.icon.size)),e.icon.hasOwnProperty("scaledSize")&&Array.isArray(e.icon.scaledSize)&&2===e.icon.scaledSize.length&&(t.scaledSize=this.formatSize(e.icon.scaledSize)),e.icon.hasOwnProperty("anchor")&&Array.isArray(e.icon.anchor)&&2===e.icon.anchor.length&&(t.anchor=this.formatPoint(e.icon.anchor))}return t},processMarker:function(t,o,n,r,i){var s=this,l=s.get("marker"),p={},c={},d={};r.hasOwnProperty("position")&&("function"==typeof r.getPosition&&s._bounds.extend(r.position),n.hasOwnProperty("markerFitBounds")&&!0===n.markerFitBounds&&l.length===n.marker.length&&o.fitBounds(s._bounds)),void 0===r.infoWindow&&(r.infoWindow=new google.maps.InfoWindow({content:r.text})),r.hasOwnProperty("text")&&(r.infoWindow.setContent(r.text),r.hasOwnProperty("event")&&r.event.hasOwnProperty("click")||(r.defaultInfoWindow=!0),s.bindEvents(r,r.event),r.hasOwnProperty("infoWindowOptions")&&(d=e.extend({},{content:r.infoWindowOptions.hasOwnProperty("content")?r.infoWindowOptions.content:r.text},r.infoWindowOptions),r.infoWindow.setOptions(d),d.hasOwnProperty("event")&&void 0!==d.event&&s.bindEvents(r.infoWindow,d.event))),(!r.hasOwnProperty("cluster")||r.hasOwnProperty("cluster")&&!0===r.cluster)&&"function"==typeof s._clusters.addMarker&&s._clusters.addMarker(r),(n.hasOwnProperty("markerWithLabel")&&!0===n.markerWithLabel||r.hasOwnProperty("newLabel")&&r.newLabel)&&(c={id:r.id,text:r.newLabel,map:o,css:r.hasOwnProperty("newLabelCSS")?r.newLabelCSS.toString():""},s.get({label:[r.id]},function(t){var o=t.label.length;o?t.label.forEach(function(t){t.text=r.newLabel,e(t.span).addClass(r.newLabelCSS),t.bindTo("position",r),t.draw()}):(p=new a(c),p.bindTo("position",r),s._labels.push(p),p.set("visible",r.showLabel),"object"==typeof p&&!0===n.markerCluster&&google.maps.event.addListener(r,"map_changed",function(){"function"==typeof p.setMap&&p.set("visible",null!==r.getMap())}))})),s.bindEvents(r,r.event)},markerControl:function(){var t,o=this,n=o.options,r={css:"",label:"請選擇&hellip;",infoWindow:!0,panTo:!0,onChange:""};n.hasOwnProperty("markerControl")&&("string"==typeof n.markerControl?t=e(n.markerControl.toString()):(t=e(n.markerControl.hasOwnProperty("container")?n.markerControl.container:n.markerControl),r=e.extend({},r,n.markerControl)),t.length&&o.get("marker",function(n){var i=['<select class="marker-list-control">',"<option>"+r.label+"</option>"];n.forEach(function(e){void 0!==e.infoWindow&&e.infoWindow.close(),i.push('<option value="'+e.id+'" data-marker-id="'+e.id+'">'+(e.title?e.title:e.id)+"</option>")}),i.push("</select>"),t.on("change.tinyMap","select",function(){var t=e(this);o.close("marker"),this.value.length&&o.get({marker:[this.value]},function(e){var n={};e.marker.length&&"undefined"!==e.marker[0]&&(n=e.marker[0],!0===r.infoWindow&&void 0!==n.infoWindow&&"function"==typeof n.infoWindow.open&&n.infoWindow.open(o.map,n),!0===r.panTo&&o.map.panTo(n.getPosition()),"function"==typeof r.onChange&&r.onChange.call(t,n))})}).html(i.join("")),"string"==typeof r.css&&t.find("select").addClass(r.css)}))},placeMarkers:function(t,o,n,r){var s=this,l={},p={maxZoom:null,gridSize:60},c=Array.isArray(o.marker)?o.marker:[],d={},g=!1;void 0!==r&&Array.isArray(r)&&r.length&&(c=r),s.options.hasOwnProperty("markerCluster")&&"function"==typeof MarkerClusterer&&(p=e.extend({},p,o.markerCluster),s._clusters=new MarkerClusterer(t,[],p),p.hasOwnProperty("event")&&s.bindEvents(s._clusters,p.event)),s.options.hasOwnProperty("enableOMS")&&"function"==typeof OverlappingMarkerSpiderfier&&(g=!0),g&&(d=new OverlappingMarkerSpiderfier(t,{markersWontHide:!0}),d.addListener("click",function(e){e.hasOwnProperty("oms")&&e.infoWindow.setContent(e.oms),e.infoWindow.open(t,e)}),d.addListener("spiderfy",function(e){}),d.addListener("unspiderfy",function(e){}));var y=c.length;if(c.forEach(function(r,a){var p=i(r.addr,!0),c=s.markerIcon(r),f=!0,h=!1,u={},m={},w=void 0!==r.id?r.id:r.addr.toString().replace(/\s/g,""),v={id:w,map:t,animation:null,showLabel:!0};v=e.extend({},v,r),"modify"===n&&w&&s.get({marker:[w]},function(t){Array.isArray(t.marker)&&t.marker.length&&(r.hasOwnProperty("forceInsert")&&!0===r.forceInsert||(r=e.extend(t.marker[0],r),"function"==typeof s._clusters.removeMarker&&s._clusters.removeMarker(t.marker[0]),f=!1,h=!0))}),r.hasOwnProperty("title")&&(v.title=r.title.toString().replace(/<([^>]+)>/g,"")),e.isEmptyObject(c)||(v.icon=c),r.hasOwnProperty("animation")&&"string"==typeof r.animation&&(v.animation=google.maps.Animation[r.animation.toUpperCase()]),"string"==typeof p?(l=new google.maps.Geocoder,l.geocode({address:p},function(e,i){i===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?setTimeout(function(){s.placeMarkers(y,t,o,n,[r])},s.interval*(a+1)):i===google.maps.GeocoderStatus.OK&&(!f&&h?("function"==typeof r.setPosition&&(r.setPosition(e[0].geometry.location),v.hasOwnProperty("title")&&r.setTitle(v.title),v.hasOwnProperty("icon")&&r.setIcon(v.icon)),m=r):(v.position=e[0].geometry.location,u=o.hasOwnProperty("markerWithLabel")&&!0===o.markerWithLabel&&"function"==typeof MarkerWithLabel?new MarkerWithLabel(v):new google.maps.Marker(v),s._markers.push(u),m=u),g&&d.addMarker(m),s.processMarker(y,t,o,m,n))})):(!f&&h?("function"==typeof r.setPosition&&p.lat()&&p.lng()&&r.setPosition(p),v.hasOwnProperty("title")&&r.setTitle(v.title),v.hasOwnProperty("icon")&&r.setIcon(v.icon),m=r):(v.position=p,u=o.hasOwnProperty("markerWithLabel")&&!0===o.markerWithLabel&&"function"==typeof MarkerWithLabel?new MarkerWithLabel(v):new google.maps.Marker(v),s._markers.push(u),m=u,g&&d.addMarker(m)),s.processMarker(y,t,o,m,n))}),o.hasOwnProperty("markerWithLabel")&&e.isNumeric(o.markerWithLabel)){({idle:{func:function(){s.clear("label");var e=t.getCenter(),o=[];s.get("marker",function(n){n.forEach(function(t){google.maps.geometry.spherical.computeDistanceBetween(t.getPosition(),e)<1e3&&o.push(t)}),o&&o.forEach(function(e){var o={id:e.id,text:e.newLabel,map:t,css:e.hasOwnProperty("newLabelCSS")?e.newLabelCSS.toString():""},n=new a(o);n.bindTo("position",e),n.set("visible",e.showLabel),s._labels.push(n)})})},once:!1}}).idle.func.apply(s,arguments)}s.markerControl()},directionService:function(t,o){var n=this,r=new google.maps.DirectionsService;Array.isArray(o.direction)&&o.direction.forEach(function(o){if(void 0!==o.from&&void 0!==o.to){var a={},s=new google.maps.DirectionsRenderer,l=e.extend({},{infoWindow:new google.maps.InfoWindow,map:n.map},o),p=[],c=[],d=[];a.origin=i(o.from,!0,!1),a.destination=i(o.to,!0,!1),a.travelMode=o.hasOwnProperty("travel")&&google.maps.TravelMode[o.travel.toString().toUpperCase()]?google.maps.TravelMode[o.travel.toString().toUpperCase()]:google.maps.TravelMode.DRIVING,o.hasOwnProperty("panel")&&e(o.panel).length&&(l.panel=e(o.panel).get(0)),o.hasOwnProperty("requestExtra")&&o.requestExtra&&(a=e.extend({},a,o.requestExtra)),o.hasOwnProperty("optimize")&&(a.optimizeWaypoints=o.optimize),o.hasOwnProperty("waypoint")&&Array.isArray(o.waypoint)&&(o.waypoint.forEach(function(e){var t={stopover:!0};"string"==typeof e||Array.isArray(e)?t.location=i(e,!0):e.hasOwnProperty("location")&&(t.location=i(e.location,!0),t.stopover=!e.hasOwnProperty("stopover")||e.stopover),c.push(e.text||e.toString()),e.hasOwnProperty("icon")&&d.push(e.icon.toString()),p.push(t)}),a.waypoints=p),r.route(a,function(e,r){r===google.maps.DirectionsStatus.OK&&(e.routes.forEach(function(r,i){if(o.hasOwnProperty("renderAll")&&!0===o.renderAll&&!0===a.provideRouteAlternatives){new google.maps.DirectionsRenderer({map:t,directions:e,routeIndex:i})}var s=r.legs,p="",g="",y={},f=0;for(o.hasOwnProperty("fromText")&&(s[0].start_address=o.fromText,p=o.fromText),o.hasOwnProperty("toText")&&(1===s.length?s[0].end_address=o.toText:s[s.length-1].end_address=o.toText,g=o.toText),o.hasOwnProperty("icon")&&(l.suppressMarkers=!0,o.icon.hasOwnProperty("from")&&"string"==typeof o.icon.from&&n.directionServiceMarker(s[0].start_location,{icon:o.icon.from,text:p},l.infoWindow,o),o.icon.hasOwnProperty("to")&&"string"==typeof o.icon.to&&n.directionServiceMarker(s[s.length-1].end_location,{icon:o.icon.to,text:g},l.infoWindow,o)),f=1;f<s.length;f+=1)o.hasOwnProperty("icon")&&(o.icon.hasOwnProperty("waypoint")&&"string"==typeof o.icon.waypoint?y.icon=o.icon.waypoint:"string"==typeof d[f-1]&&(y.icon=d[f-1]),y.text=c[f-1],n.directionServiceMarker(s[f].start_location,y,l.infoWindow,o))}),n.bindEvents(s,o.event),s.setOptions(l),s.setDirections(e),n._directions.push(s))})}})},directionServiceMarker:function(t,o,n,r){var i=this,a={},s=e.extend({},{position:t,map:i.map,id:r.hasOwnProperty("id")?r.id:""},o),l=new google.maps.Marker(s);s.hasOwnProperty("text")&&(a=function(){n.setPosition(t),n.setContent(s.text),n.open(i.map,l)}),i._directionsMarkers.push(l),i.bindEvents(l,a)},getDirectionsInfo:function(){var e=[];return this.get("direction",function(t){t.forEach(function(t,o){var n=t.getDirections();n.hasOwnProperty("routes")&&void 0!==n.routes[0]&&void 0!==n.routes[0].legs&&(e[o]=[],n.routes[0].legs.forEach(function(t,n){e[o].push({from:t.start_address,to:t.end_address,distance:t.distance,duration:t.duration})}))})}),e},streetView:function(t,o){var n=this,r=o.hasOwnProperty("streetViewObj")?o.streetViewObj:{},a={},s={};"function"==typeof t.getStreetView&&(r.hasOwnProperty("position")?(s=i(r.position,!0,!1),r.position="object"==typeof s?t.getCenter():s):r.position=t.getCenter(),r.hasOwnProperty("pov")&&(r.pov=e.extend({},{heading:0,pitch:0,zoom:1},r.pov)),a=t.getStreetView(),a.setOptions(r),r.hasOwnProperty("event")&&n.bindEvents(a,r.event),r.hasOwnProperty("visible")&&a.setVisible(r.visible))},places:function(t,o){var n=this,r={},a=o.hasOwnProperty("places")?o.places:{},s=e.extend({location:t.getCenter(),radius:100},a);s.location=i(s.location,!0,!1),void 0!==google.maps.places&&(r=new google.maps.places.PlacesService(t),r.nearbySearch(s,function(e,o){o===google.maps.places.PlacesServiceStatus.OK&&(n._places.push(e),s.hasOwnProperty("createMarker")&&!0===s.createMarker&&e.forEach(function(e){e.hasOwnProperty("geometry")&&n._markers.push(new google.maps.Marker({map:t,position:e.geometry.location}))}),s.hasOwnProperty("callback")&&"function"==typeof s.callback&&s.callback.call(e))}))},geoLocation:function(t,o){try{var n=this,r={},i=navigator.geolocation;if(!i)return;o.hasOwnProperty("geolocation")&&(r=e.extend({},{maximumAge:6e5,timeout:3e3,enableHighAccuracy:!1},o.geolocation)),!0===o.autoLocation||"function"==typeof o.autoLocation?this.watchid=i.watchPosition(function(e){void 0!==e&&"coords"in e&&"latitude"in e.coords&&"longitude"in e.coords&&(t.panTo(new google.maps.LatLng(e.coords.latitude,e.coords.longitude)),"function"==typeof o.autoLocation&&o.autoLocation.call(n,e))},function(e){},r):i.clearWatch(this.watchid)}catch(e){}},panTo:function(t,o){var n=this.map,r={},a={};return null!==n&&void 0!==n&&(r=i(t,!0,!1),"string"==typeof r?(a=new google.maps.Geocoder,a.geocode({address:r},function(e,t){t===google.maps.GeocoderStatus.OK&&"function"==typeof n.panTo&&Array.isArray(e)&&e.length?e[0].hasOwnProperty("geometry")&&n.panTo(e[0].geometry.location):"function"==typeof o&&o.call(this,t)})):"function"==typeof n.panTo&&n.panTo(r)),e(this.container)},close:function(t,o){var n=this,r=n.get(t),i={},a="";r.hasOwnProperty("map")&&delete r.map,Array.isArray(r)?i[t]=r:i=r;try{for(a in i)Array.isArray(i[a])&&i[a].forEach(function(e){e.hasOwnProperty("infoWindow")&&"function"==typeof e.infoWindow.close&&e.infoWindow.close()});"function"==typeof o&&o.call(this)}catch(e){}finally{return e(n.container)}},clear:function(t,o){function n(e,t){"function"==typeof e.setMap&&a._directionsMarkers[t].setMap(null)}function r(e){"direction"===d&&(s.forEach(n),a._directionsMarkers.filter(function(e){return void 0!==e})),"function"==typeof e.set&&e.set("visible",!1),"function"==typeof e.setMap&&e.setMap(null),-1!==a[c].indexOf(e)&&delete a[c][a[c].indexOf(e)]}function i(e){return void 0!==e}var a=this,s=a._directionsMarkers,l=a.get(t),p={},c="",d="";void 0!==l&&void 0!==l.map&&delete l.map,Array.isArray(l)?p[t]=l:p=l;try{for(d in p)Array.isArray(p[d])&&(c="_"+d.toString().toLowerCase()+"s",p[d].forEach(r),a[c]=a[c].filter(i));"function"==typeof o&&o.call(this)}catch(e){}finally{return e(a.container)}},get:function(e,t){function o(t){var o=n[s].indexOf(t);(0===e[a].length||-1!==e[a].indexOf(o)||void 0!==t.id&&0<t.id.length&&-1!==t.id.indexOf(e[a]))&&i[a].push(t)}var n=this,r=[],i={},a={},s="",l="",p=0;void 0===e&&(e={marker:[],label:[],polygon:[],polyline:[],circle:[],direction:[],kml:[],cluster:[],bound:[]});try{if("string"==typeof e)if(-1!==e.indexOf(","))for(r=e.replace(/\s/gi,"").split(","),p=0;p<r.length;p+=1)l=r[p].toString().toLowerCase(),"map"===l?i[l]=n.map:(s="_"+l+"s",i[l]=n[s]);else"map"===e.toString().toLowerCase()?i=n.map:(s="_"+e.toString().toLowerCase()+"s",i=n[s]);else{for(a in e)Array.isArray(e[a])&&(s="_"+a.toString().toLowerCase()+"s",Array.isArray(n[s])&&(i[a]=[],n[s].forEach(o)));i.map=n.map}return"function"==typeof t&&t.call(this,i),i}catch(e){}finally{return i}},modify:function(t){var o=this,n=[],r=[["kml","kml"],["marker","placeMarkers"],["direction","directionService"],["polyline","drawPolyline"],["polygon","drawPolygon"],["circle","drawCircle"],["streetView","streetView"],["markerFitBounds","markerFitBounds"],["places","places"],["autoLocation","geoLocation"]],i=0,a=o.map;if(void 0!==t){for(i=0;i<r.length;i+=1)t.hasOwnProperty(r[i][0])&&n.push(r[i][1]);if(null!==a){if(n.length)for(i=0;i<n.length;i+=1)"function"==typeof o[n[i]]&&("streetView"===n[i]&&(t.streetViewObj=t.streetView,delete t.streetView),o[n[i]](a,t,"modify"));else a.setOptions(t);t.hasOwnProperty("event")&&o.bindEvents(a,t.event),google.maps.event.trigger(a,"resize")}}return e(this.container)},query:function(e,t){var o=this,n=new google.maps.Geocoder,r=i(e,!1,!0),a={};"string"==typeof r?a.address=r:a={location:{lat:parseFloat(r.lat,10),lng:parseFloat(r.lng,10)}},n.geocode(a,function(n,r){try{if(r===google.maps.GeocoderStatus.OVER_QUERY_LIMIT)setTimeout(function(){o.query(e,t)},o.interval);else if(r===google.maps.GeocoderStatus.OK&&Array.isArray(n)&&0<n.length&&n[0].hasOwnProperty("geometry")){if("function"!=typeof t)return n[0];t.call(o,n[0])}}catch(e){}})},destroy:function(){var t=e(this.container);return t.length&&e.removeData(this.container,"tinyMap"),t.empty()},getKML:function(o){var n=this,r=e.extend({},{marker:!0,polyline:!0,polygon:!0,circle:!0,direction:!0,download:!1},o),i={xml:['<?xml version="1.0" encoding="UTF-8"?>','<kml xmlns="http://earth.google.com/kml/2.2">',"<Document>","<name><![CDATA[jQuery tinyMap Plugin]]></name>","<description><![CDATA[]]></description>",'<Style id="style1">',"<PolyStyle>","<color>50F05A14</color>","<colorMode>normal</colorMode>","<fill>1</fill>","<outline>1</outline>","</PolyStyle>","<IconStyle>","<Icon>","<href>https://maps.google.com/mapfiles/kml/paddle/grn-circle_maps.png</href>","</Icon>","</IconStyle>","</Style>","#PLACEMARKS#","</Document>","</kml>"],placemark:["<Placemark>","<name><![CDATA[#NAME#]]></name>","<Snippet></Snippet>","<description><![CDATA[]]></description>","<styleUrl>#style1</styleUrl>","<ExtendedData></ExtendedData>","#DATA#","</Placemark>"],polygon:["<Placemark>","<styleUrl>#style1</styleUrl>","<name><![CDATA[#NAME#]]></name>","<Polygon>","<tessellate>1</tessellate>","<extrude>1</extrude>","<altitudeMode>clampedToGround</altitudeMode>","<outerBoundaryIs>","<LinearRing>","<coordinates>#LATLNG#</coordinates>","</LinearRing>","</outerBoundaryIs>","</Polygon>","</Placemark>"],linestring:"<LineString><tessellate>1</tessellate><coordinates>#LATLNG#</coordinates></LineString>",point:"<Point><coordinates>#LATLNG#,0.000000</coordinates></Point>"},a="",s="",l="",p="",c="",d="";if(n.get("marker,polyline,polygon,circle,direction",function(e){var t="";!0===r.marker&&void 0!==e.marker&&e.marker.forEach(function(e){t=[e.getPosition().lng(),e.getPosition().lat()].join(","),a+=i.placemark.join("").replace(/#NAME#/gi,"Markers").replace(/#DATA#/gi,i.point.replace(/#LATLNG#/gi,t))}),!0===r.polyline&&void 0!==e.polyline&&e.polyline.forEach(function(e){t="",e.getPath().getArray().forEach(function(e){t+=[e.lng(),e.lat(),"0.000000\n"].join(",")}),s+=i.placemark.join("").replace(/#NAME#/gi,"Polylines").replace(/#DATA#/gi,i.linestring.replace(/#LATLNG#/gi,t))}),!0===r.polygon&&void 0!==e.polygon&&e.polygon.forEach(function(e){t="",e.getPath().getArray().forEach(function(e){t+=[e.lng(),e.lat(),"0.000000\n"].join(",")}),l+=i.polygon.join("").replace(/#NAME#/gi,"Polygons").replace(/#LATLNG#/gi,t)}),!0===r.circle&&void 0!==e.circle&&e.circle.forEach(function(e){t="";var o=Math.PI/180,n=180/Math.PI,r=e.getRadius()/6378137*n,a=r/Math.cos(e.getCenter().lat()*o),s=0,l=0,c=0,d=0;for(d=0;d<65;d+=1)s=Math.PI*(d/32),l=e.getCenter().lng()+a*Math.cos(s),c=e.getCenter().lat()+r*Math.sin(s),t+=[l,c,"0.000000\n"].join(",");p+=i.polygon.join("").replace(/#NAME#/gi,"Circles").replace(/#LATLNG#/gi,t)}),!0===r.direction&&void 0!==e.direction&&e.direction.forEach(function(e){var o=e.getDirections();o.hasOwnProperty("routes")&&Array.isArray(o.routes)&&void 0!==o.routes[0]&&void 0!==o.routes[0].legs&&Array.isArray(o.routes[0].legs)&&o.routes[0].legs.forEach(function(e){Array.isArray(e.steps)&&e.steps.forEach(function(e){t="",Array.isArray(e.path)&&e.path.forEach(function(e){t+=[e.lng(),e.lat(),"0.000000\n"].join(",")}),c+=i.placemark.join("").replace(/#NAME#/gi,"Directions").replace(/#DATA#/gi,i.linestring.replace(/#LATLNG#/gi,t))})})})}),d=i.xml.join("").replace(/#NAME#/gi,"").replace(/#PLACEMARKS#/gi,a+s+l+p+c),!0!==r.download)return d;t.open("data:application/vnd.google-earth.kml+xml;charset=utf-8;base64,"+t.btoa(t.decodeURIComponent(t.encodeURIComponent(d))))},init:function(){var n,s=this,y={},h={},u=e.extend({},g),m=u.api.split("?")[0],w="",v={},O={};try{delete u.api,delete u.clusterer,delete u.withLabel,u=e.param(u)}catch(e){}if(l||void 0!==t.google||(y=o.createElement("script"),y.setAttribute("src",[m,u].join("?")),(o.getElementsByTagName("head")[0]||o.documentElement).appendChild(y),l=!0,y=null),"object"==typeof t.google){r(s.options),!p&&s.options.hasOwnProperty("markerCluster")&&!1!==s.options.markerCluster&&"undefined"==typeof MarkerClusterer&&(y=o.createElement("script"),y.setAttribute("src",g.clusterer),(o.getElementsByTagName("head")[0]||o.documentElement).appendChild(y),p=!0,y=null),!c&&s.options.hasOwnProperty("markerWithLabel")&&!0===s.options.markerWithLabel&&"undefined"==typeof MarkerWithLabel&&(y=o.createElement("script"),y.setAttribute("src",g.withLabel),(o.getElementsByTagName("head")[0]||o.documentElement).appendChild(y),c=!0,y=null),!d&&s.options.hasOwnProperty("enableOMS")&&"undefined"==typeof OverlappingMarkerSpiderfier&&(y=o.createElement("script"),y.setAttribute("src",g.OMS),(o.getElementsByTagName("head")[0]||o.documentElement).appendChild(y),d=!0,y=null),s._bounds=new google.maps.LatLngBounds,a.prototype=new google.maps.OverlayView,a.prototype.onAdd=function(){var t=this;null!==t.div&&(t.div.appendTo(e(t.getPanes().overlayLayer)),t.listeners=[google.maps.event.addListener(t,"visible_changed",function(){t.draw()}),google.maps.event.addListener(t,"position_changed",function(){t.draw()}),google.maps.event.addListener(t,"visible_changed",function(){t.draw()}),google.maps.event.addListener(t,"clickable_changed",function(){t.draw()}),google.maps.event.addListener(t,"text_changed",function(){t.draw()}),google.maps.event.addListener(t,"zindex_changed",function(){t.draw()})])},a.prototype.draw=function(){var e=this,t=e.getProjection(),o={};try{null!==e.div&&t&&(o=t.fromLatLngToDivPixel(e.get("position")),o&&e.div.css({left:o.x+"px",top:o.y+"px",display:e.get("visible")?"block":"none"}),e.text&&e.span.html(e.text.toString()))}catch(e){}},a.prototype.onRemove=function(){e(this.div).remove(),this.div=null};for(O in s.options)s.options.hasOwnProperty(O)&&(v=s.options[O],/ControlOptions/g.test(O)&&v.hasOwnProperty("position")&&"string"==typeof v.position&&(s.options[O].position=google.maps.ControlPosition[v.position.toUpperCase()]));s.googleMapOptions=s.options,s.options.hasOwnProperty("streetView")&&(s.googleMapOptions.streetViewObj=s.options.streetView,delete s.googleMapOptions.streetView),s.googleMapOptions.center=i(s.options.center,!0,!1),s.options.hasOwnProperty("styles")&&("string"==typeof s.options.styles&&f.hasOwnProperty(s.options.styles)?s.googleMapOptions.styles=f[s.options.styles]:Array.isArray(s.options.styles)&&(s.googleMapOptions.styles=s.options.styles)),"string"==typeof s.options.center?(h=new google.maps.Geocoder,h.geocode({address:s.options.center},function(t,o){try{o===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?setTimeout(function(){s.init()},s.interval):o===google.maps.GeocoderStatus.OK&&Array.isArray(t)?0<t.length&&t[0].hasOwnProperty("geometry")&&(s.googleMapOptions.center=t[0].geometry.location,s.map=new google.maps.Map(s.container,s.googleMapOptions),n=void 0!==s.options.event?s.options.event:{},s.mapIdleEvent(n)):(w=(s.options.notFound||o).toString(),s.container.innerHTML=e("<div/>").text(w).html())}catch(e){}})):(s.map=new google.maps.Map(s.container,s.googleMapOptions),n=void 0!==s.options.event?s.options.event:{},s.mapIdleEvent(n))}},mapIdleEvent:function(e){var t=this;e.hasOwnProperty("idle")?"undefined"!==e.idle.func&&"function"==typeof e.idle.func&&void 0!==e.idle.once?(!0===e.idle.once?google.maps.event.addListenerOnce(t.map,"idle",function(){t.overlay(),e.idle.func.apply(this,arguments),delete e.idle}):google.maps.event.addListener(t.map,"idle",function(){t.overlay(),e.idle.func.apply(this,arguments)}),t.bindEvents(t.map,e)):("function"==typeof e.idle&&google.maps.event.addListener(t.map,"idle",function(){t.overlay(),e.idle.apply(this,arguments)}),t.bindEvents(t.map,e)):(google.maps.event.addListenerOnce(t.map,"idle",function(){t.overlay()}),t.bindEvents(t.map,e))}},e.fn.tinyMapConfigure=function(t){g=e.extend(g,t)},e.fn.tinyMap=function(t){var o={},n=[],r=arguments,i="tinyMap";return"string"==typeof t?(this.each(function(){(o=e.data(this,i))instanceof s&&"function"==typeof o[t]&&(n=o[t].apply(o,Array.prototype.slice.call(r,1)))}),void 0!==n?n:this):this.each(function(){e.data(this,i)||e.data(this,i,new s(this,t))})}}(window.jQuery||{},window,document);